<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academic Secure Chat</title>
    <link rel="stylesheet" href="stvor.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@300;400;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
</head>
<body>
    <div class="container">
        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è -->
        <div id="welcomeScreen" class="welcome-screen">
            <div class="welcome-card">
                <div class="academic-header">
                    <div class="university-logo">üìö</div>
                    <h1>Academic Secure Chat</h1>
                    <p class="academic-subtitle">–ó–∞—â–∏—â—ë–Ω–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è –¥–ª—è –Ω–∞—É—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</p>
                </div>
                
                <div id="authForms">
                    <div id="loginForm">
                        <h2 class="form-title">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
                        <div class="input-group">
                            <input type="text" id="loginUsername" placeholder="–í–∞—à –ª–æ–≥–∏–Ω" class="academic-input">
                        </div>
                        <div class="input-group">
                            <input type="password" id="loginPassword" placeholder="–í–∞—à –ø–∞—Ä–æ–ª—å" class="academic-input">
                        </div>
                        <div class="button-group">
                            <button class="btn-academic" onclick="login()">–í–æ–π—Ç–∏</button>
                            <button class="btn-academic-secondary" onclick="showRegisterForm()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                        </div>
                    </div>
                    
                    <div id="registerForm" style="display:none;">
                        <h2 class="form-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                        <div class="input-group">
                            <input type="text" id="regUsername" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω" class="academic-input">
                        </div>
                        <div class="input-group">
                            <input type="password" id="regPassword" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å" class="academic-input">
                        </div>
                        <div class="input-group">
                            <input type="password" id="regConfirmPassword" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" class="academic-input">
                        </div>
                        <div class="input-group">
                            <input type="text" id="regFullName" placeholder="–í–∞—à–µ –ø–æ–ª–Ω–æ–µ –∏–º—è" class="academic-input">
                        </div>
                        <div class="button-group">
                            <button class="btn-academic" onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                            <button class="btn-academic-secondary" onclick="showLoginForm()">–ù–∞–∑–∞–¥</button>
                        </div>
                    </div>
                </div>
                
                <div class="academic-footer">
                    <p>–°–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π<br>–ö–∞—Ñ–µ–¥—Ä–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</p>
                </div>
            </div>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞) -->
        <div id="mainApp" style="display:none;">
            <header class="academic-header">
                <div class="header-content">
                    <div class="user-info">
                        <div class="user-avatar">üë§</div>
                        <div>
                            <h1>Academic Secure Chat</h1>
                            <p class="subtitle">–í—ã –≤–æ—à–ª–∏ –∫–∞–∫: <span id="currentUserDisplay"></span></p>
                        </div>
                    </div>
                    <button class="btn-logout" onclick="logout()">–í—ã–π—Ç–∏</button>
                </div>
                <nav class="academic-nav">
                    <button class="nav-btn active" data-target="chatSection">–ß–∞—Ç—ã</button>
                    <button class="nav-btn" data-target="encryptSection">–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</button>
                    <button class="nav-btn" data-target="contactsSection">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
                </nav>
            </header>
            
            <!-- –°–µ–∫—Ü–∏—è —á–∞—Ç–æ–≤ -->
            <section id="chatSection" class="app-section">
                <div class="chat-container">
                    <div class="chat-sidebar">
                        <div class="search-container">
                            <input type="text" id="contactSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π..." class="academic-input">
                            <button onclick="searchUsers()" class="btn-search">üîç</button>
                        </div>
                        <div class="chat-list-container">
                            <ul id="chatList"></ul>
                        </div>
                    </div>
                    
                    <div class="chat-main">
                        <div class="chat-header" id="currentChatHeader">
                            <h3>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ª–æ–≥</h3>
                        </div>
                        <div class="chat-messages" id="chatMessages">
                            <div class="empty-chat">
                                <div class="empty-icon">üí¨</div>
                                <p>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ª–æ–≥ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</p>
                            </div>
                        </div>
                        <div class="chat-input">
                            <textarea id="chatMessageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." class="academic-textarea"></textarea>
                            <div class="chat-buttons">
                                <button class="btn-academic" onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                                <button class="btn-academic-secondary" onclick="encryptSelected()">–ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- –°–µ–∫—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è -->
            <section id="encryptSection" class="app-section" style="display:none;">
                <div class="card academic-card">
                    <h3 class="academic-title">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è</h3>
                    <div class="input-group">
                        <label for="recipient">–ü–æ–ª—É—á–∞—Ç–µ–ª—å</label>
                        <input type="text" id="recipient" placeholder="–õ–æ–≥–∏–Ω –ø–æ–ª—É—á–∞—Ç–µ–ª—è" class="academic-input">
                    </div>
                    
                    <div class="message-container">
                        <label for="message">–°–æ–æ–±—â–µ–Ω–∏–µ</label>
                        <textarea id="message" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è..." class="academic-textarea"></textarea>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn-academic" onclick="encryptMessage()">
                            <span class="icon">üîí</span> –ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="btn-academic-secondary" onclick="decryptMessage()">
                            <span class="icon">üîì</span> –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="btn-export" onclick="exportMessages()">
                            <span class="icon">üíæ</span> –≠–∫—Å–ø–æ—Ä—Ç
                        </button>
                    </div>
                </div>
                
                <div class="card academic-card result-card">
                    <h3 class="academic-title">–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
                    <div id="result"></div>
                </div>
            </section>
            
            <!-- –°–µ–∫—Ü–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ -->
            <section id="contactsSection" class="app-section" style="display:none;">
                <div class="card academic-card">
                    <h3 class="academic-title">–ú–æ–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                    <div class="search-container">
                        <input type="text" id="userSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π..." class="academic-input">
                        <button onclick="searchAllUsers()" class="btn-search">üîç</button>
                    </div>
                    <ul id="contactList" class="contact-list"></ul>
                </div>
            </section>
            
            <footer class="academic-footer">
                <p>Academic Secure Chat v2.0 | –ö–∞—Ñ–µ–¥—Ä–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</p>
                <p>–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞—â–∏—â–µ–Ω—ã —Å–∫–≤–æ–∑–Ω—ã–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º</p>
            </footer>
        </div>
    </div>

    <script type="module" src="stvor.js"></script>
    <script src="security.js"></script>
</body>
</html>    
